# Redis å¯¦é©—å ´æ™¯é¸æ“‡åŠŸèƒ½
========================

## ğŸ¯ åŠŸèƒ½æ¦‚è¦½

æ–°å¢å ´æ™¯é¸æ“‡åŠŸèƒ½ï¼Œå…è¨±ç”¨æˆ¶åœ¨é¸æ“‡æ¸¬è©¦æ¨¡å¼å¾Œï¼Œé€²ä¸€æ­¥æŒ‡å®šè¦åŸ·è¡Œçš„å…·é«”å ´æ™¯ï¼Œæ”¯æ´å¤šå ´æ™¯é¸æ“‡å’Œé€—è™Ÿåˆ†éš”è¼¸å…¥ã€‚

## âœ¨ ä¸»è¦ç‰¹è‰²

### 1. æ™ºèƒ½å ´æ™¯è©¢å•
- **è¨“ç·´æ¨¡å¼**: è‡ªå‹•åŸ·è¡Œæ‰€æœ‰å ´æ™¯ï¼ˆä¸è©¢å•ï¼‰
- **æ¸¬è©¦æ¨¡å¼**: è©¢å•è¦åŸ·è¡Œå“ªäº›å ´æ™¯
- **æ··åˆæ¨¡å¼**: è©¢å•è¦åŸ·è¡Œå“ªäº›å ´æ™¯

### 2. å¤šç¨®è¼¸å…¥æ–¹å¼
- **æ•¸å­—é¸æ“‡**: `1,2,3` (offpeak, peak, rushsale)
- **å ´æ™¯åç¨±**: `peak,rushsale,fluctuating`
- **æ··åˆè¼¸å…¥**: `1,peak,4` (offpeak, peak, fluctuating)
- **å…¨é¸**: `all` æˆ– `a` (æ‰€æœ‰å ´æ™¯)

### 3. è¼¸å…¥é©—è­‰
- è‡ªå‹•é©—è­‰å ´æ™¯åç¨±å’Œæ•¸å­—
- å¿½ç•¥å¤§å°å¯«
- é‡è¤‡é¸æ“‡è‡ªå‹•å»é‡
- ç„¡æ•ˆè¼¸å…¥æç¤ºé‡æ–°é¸æ“‡

## ğŸ“‹ ç”¨æˆ¶äº’å‹•æµç¨‹

### å®Œæ•´çš„é¸æ“‡æµç¨‹
```
1. é¸æ“‡å¯¦é©—æ–¹æ³•: Gym-HPA
   - 1. train - åªåŸ·è¡Œè¨“ç·´
   - 2. test - åªåŸ·è¡Œæ¸¬è©¦ (éœ€è¦ç¾æœ‰æ¨¡å‹)
   - 3. both - åŸ·è¡Œè¨“ç·´å¾Œæ¥è‘—æ¸¬è©¦
   - 4. skip - è·³éæ­¤æ–¹æ³•

2. å¦‚æœé¸æ“‡ test æˆ– bothï¼Œé€²ä¸€æ­¥è©¢å•å ´æ™¯:
   Gym-HPA è¦åŸ·è¡Œå“ªäº›å ´æ™¯ï¼Ÿ
   å¯ç”¨å ´æ™¯:
     1. offpeak
     2. peak
     3. rushsale
     4. fluctuating
     a. all - æ‰€æœ‰å ´æ™¯
   
   è«‹é¸æ“‡å ´æ™¯ (å¯ç”¨é€—è™Ÿåˆ†éš”å¤šé¸ï¼Œå¦‚: 1,2 æˆ– peak,rushsale):
```

### è¼¸å…¥ç¯„ä¾‹
```bash
# åªåŸ·è¡Œ peak å ´æ™¯
è¼¸å…¥: 2
æˆ–: peak

# åŸ·è¡Œ peak å’Œ rushsale å ´æ™¯
è¼¸å…¥: 2,3
æˆ–: peak,rushsale
æˆ–: 2,rushsale

# åŸ·è¡Œæ‰€æœ‰å ´æ™¯
è¼¸å…¥: all
æˆ–: a

# åŸ·è¡Œ offpeak, rushsale, fluctuating
è¼¸å…¥: 1,3,4
æˆ–: offpeak,rushsale,fluctuating
```

## ğŸ”§ æŠ€è¡“å¯¦ç¾

### æ ¸å¿ƒæ–¹æ³•

#### `ask_scenario_selection(method_name, mode)`
```python
def ask_scenario_selection(self, method_name: str, mode: str) -> list:
    """è©¢å•è¦åŸ·è¡Œå“ªäº›å ´æ™¯ï¼ˆå¯å¤šé¸ï¼‰"""
    if mode not in ['test', 'both']:  # åªæœ‰æ¸¬è©¦ç›¸é—œæ¨¡å¼æ‰è©¢å•å ´æ™¯
        return ['all']  # è¨“ç·´æ¨¡å¼åŸ·è¡Œæ‰€æœ‰å ´æ™¯
    
    available_scenarios = ['offpeak', 'peak', 'rushsale', 'fluctuating']
    # ... è¼¸å…¥è™•ç†é‚è¼¯
```

#### å ´æ™¯ç¯©é¸åŸ·è¡Œ
```python
def run_k8s_hpa_redis_experiment_with_scenarios(self, selected_scenarios: list) -> bool:
    """åŸ·è¡Œ K8s-HPA Redis å¯¦é©—ï¼ˆæ”¯æ´å ´æ™¯é¸æ“‡ï¼‰"""
    if 'all' in selected_scenarios:
        return self.run_k8s_hpa_redis_experiment()  # åŸ·è¡Œæ‰€æœ‰å ´æ™¯
    else:
        return self._run_k8s_hpa_redis_experiment_filtered(selected_scenarios)  # åŸ·è¡Œé¸å®šå ´æ™¯
```

### æ›´æ–°çš„å¯¦é©—è¨ˆåŠƒé¡¯ç¤º
```
ğŸ“‹ å¯¦é©—åŸ·è¡Œè¨ˆåŠƒ:
   GYM-HPA: æ¸¬è©¦ - å ´æ™¯: peak, rushsale
   GNNRL: è¨“ç·´+æ¸¬è©¦ - å ´æ™¯: æ‰€æœ‰å ´æ™¯
   K8S-HPA: æ¸¬è©¦ - å ´æ™¯: offpeak
```

## ğŸ’¡ ä½¿ç”¨å ´æ™¯

### 1. é‡å°ç‰¹å®šå•é¡Œå ´æ™¯æ¸¬è©¦
æ ¹æ“šåˆ†æå ±å‘Šï¼ŒOnline Boutique ä¸­ GNNRL å’Œ Gym-HPA åœ¨ peak å ´æ™¯è¡¨ç¾è¼ƒå·®ï¼š
```bash
# åªé‡åš peak å ´æ™¯æ¸¬è©¦
é¸æ“‡ GNNRL: test
é¸æ“‡å ´æ™¯: peak

é¸æ“‡ Gym-HPA: test  
é¸æ“‡å ´æ™¯: peak
```

### 2. å¿«é€Ÿé©—è­‰ç‰¹å®šå ´æ™¯
```bash
# åªæ¸¬è©¦é«˜è² è¼‰å ´æ™¯
é¸æ“‡å ´æ™¯: peak,rushsale

# åªæ¸¬è©¦ä½è² è¼‰å ´æ™¯
é¸æ“‡å ´æ™¯: offpeak

# æ¸¬è©¦æ³¢å‹•å ´æ™¯
é¸æ“‡å ´æ™¯: fluctuating
```

### 3. å®Œæ•´é‡æ¸¬
```bash
# æ‰€æœ‰å ´æ™¯å®Œæ•´æ¸¬è©¦
é¸æ“‡å ´æ™¯: all
```

## ğŸ“Š åŸ·è¡Œçµæœ

### æ—¥èªŒçµæ§‹ä¿æŒä¸€è‡´
```
logs/k8s_hpa_redis/redis_hpa_cpu-40_20250715_120000/
â”œâ”€â”€ peak_001/              # åªæœ‰é¸å®šçš„å ´æ™¯
â”‚   â”œâ”€â”€ peak_stats.csv
â”‚   â”œâ”€â”€ peak_stats_history.csv
â”‚   â”œâ”€â”€ peak.html
â”‚   â””â”€â”€ pod_metrics/
â”‚       â””â”€â”€ redis/
â”‚           â””â”€â”€ peak_pod_counts.csv
â””â”€â”€ rushsale_002/          # å¦‚æœé¸æ“‡äº† rushsale
    â”œâ”€â”€ rushsale_stats.csv
    â”œâ”€â”€ rushsale_stats_history.csv
    â”œâ”€â”€ rushsale.html
    â””â”€â”€ pod_metrics/
```

### ç›£æ§æ•¸æ“šå®Œæ•´æ€§
- æ¯å€‹é¸å®šå ´æ™¯éƒ½æœ‰å®Œæ•´çš„ Pod ç›£æ§æ•¸æ“š
- RPS å’Œå»¶é²æ•¸æ“šæ­£å¸¸è¨˜éŒ„
- æ™‚é–“åºåˆ—æ•¸æ“šä¿æŒåŒæ­¥

## ğŸš€ å¯¦éš›æ‡‰ç”¨

### åŸºæ–¼æ‚¨çš„éœ€æ±‚
æ‚¨æåˆ° "obçš„å¯¦é©—ä¸­ï¼Œåœ¨peakå ´æ™¯ç†è«–è¨­å®šrpså¤šå°‘ gnnrl gymhpa è¡¨ç¾å¾ˆå·®"ï¼Œç¾åœ¨å¯ä»¥ï¼š

1. **åªé‡åš peak å ´æ™¯**:
```bash
python run_redis_experiment.py --algorithm a2c --steps 5000

# é¸æ“‡æµç¨‹:
Gym-HPA: 2 (test)
Gym-HPA å ´æ™¯: peak

GNNRL: 2 (test)
GNNRL å ´æ™¯: peak

K8s-HPA: 4 (skip)
```

2. **å°æ¯” peak å’Œå…¶ä»–å ´æ™¯**:
```bash
# é¸æ“‡å ´æ™¯: peak,offpeak
# é€™æ¨£å¯ä»¥å°æ¯” peak å ´æ™¯çš„è¡¨ç¾èˆ‡æ­£å¸¸å ´æ™¯çš„å·®ç•°
```

3. **å®Œæ•´é‡æ¸¬é«˜è² è¼‰å ´æ™¯**:
```bash
# é¸æ“‡å ´æ™¯: peak,rushsale
# æ¸¬è©¦æ‰€æœ‰é«˜è² è¼‰å ´æ™¯çš„è¡¨ç¾
```

## âœ… é©—è­‰æ¸¬è©¦

æ‰€æœ‰åŠŸèƒ½éƒ½å·²é€šéæ¸¬è©¦é©—è­‰ï¼š
- âœ… å ´æ™¯é¸æ“‡åŠŸèƒ½
- âœ… ç„¡æ•ˆè¼¸å…¥è™•ç†
- âœ… å¯¦é©—è¨ˆåŠƒé¡¯ç¤º
- âœ… å¤šç¨®è¼¸å…¥æ ¼å¼æ”¯æ´
- âœ… èˆ‡ç¾æœ‰ç›£æ§ç³»çµ±æ•´åˆ

## ğŸ‰ ç¸½çµ

æ–°çš„å ´æ™¯é¸æ“‡åŠŸèƒ½æä¾›äº†ç²¾ç¢ºæ§åˆ¶å¯¦é©—åŸ·è¡Œçš„èƒ½åŠ›ï¼Œç‰¹åˆ¥é©åˆï¼š
- é‡å°æ€§èƒ½å•é¡Œé€²è¡Œå®šå‘æ¸¬è©¦
- å¿«é€Ÿé©—è­‰ç‰¹å®šå ´æ™¯ä¿®æ­£
- ç¯€çœå¯¦é©—æ™‚é–“å’Œè³‡æº
- ä¿æŒå®Œæ•´çš„ç›£æ§å’Œæ—¥èªŒè¨˜éŒ„

ç¾åœ¨æ‚¨å¯ä»¥ç²¾ç¢ºåœ°åªé‡åš peak å ´æ™¯ä¾†åˆ†æ GNNRL å’Œ Gym-HPA çš„è¡¨ç¾å•é¡Œï¼